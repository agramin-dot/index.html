<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اپلیکیشن تصحیح خودکار پاسخنامه واقعی</title>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif}
        :root{--primary:#4a00e0;--secondary:#8e2de2;--accent:#00b09b;--danger:#dc3545;--light:#f5f7fa;--dark:#333}
        body{background:linear-gradient(135deg,var(--primary) 0%,var(--secondary) 100%);color:var(--dark);min-height:100vh;padding:20px}
        .container{max-width:1200px;margin:0 auto;background:rgba(255,255,255,.95);border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,.15);overflow:hidden}
        header{background:linear-gradient(to right,var(--primary),var(--secondary));color:white;text-align:center;padding:25px 20px;position:relative}
        header h1{font-size:1.8rem;margin-bottom:10px}header p{font-size:1rem;opacity:.9}
        .tabs{display:flex;background:var(--light)}.tab-btn{flex:1;padding:15px;border:none;cursor:pointer;font-weight:600;transition:all .3s ease}
        .tab-btn.active{background:white;color:var(--primary);border-bottom:3px solid var(--primary)}
        .tab-content{display:none;padding:25px}.tab-content.active{display:block}
        #camera-view{width:100%;height:400px;background:#000;position:relative;display:flex;justify-content:center;align-items:center;color:white}
        .controls{display:flex;gap:10px;margin-top:10px;flex-wrap:wrap}
        button{padding:10px 15px;border:none;border-radius:8px;cursor:pointer;font-weight:600}
        .btn-primary{background:var(--primary);color:white}.btn-success{background:var(--accent);color:white}
        .btn-danger{background:var(--danger);color:white}.btn-secondary{background:#6c757d;color:white}
        .results-section{background:#f0f9ff;padding:20px;border-radius:10px;margin-top:20px;display:none}
        .answer-item{display:inline-block;margin:5px;padding:10px;border-radius:5px;font-weight:bold;min-width:40px;text-align:center}
        .correct{background:#d4edda;color:#155724}.incorrect{background:#f8d7da;color:#721c24}.empty{background:#f8f9fa;color:#6c757d}
        .a5-container{width:148mm;height:210mm;padding:8mm;margin:auto;background:white;box-shadow:0 0 10px rgba(0,0,0,.1);position:relative;page-break-inside:avoid;box-sizing:border-box}
        .sheet-marker{position:absolute;width:15px;height:15px;background:black;border:2px solid white;box-shadow:0 0 0 2px black;z-index:10}
        .sheet-marker.tl{top:5mm;left:5mm}.sheet-marker.tr{top:5mm;right:5mm}.sheet-marker.bl{bottom:5mm;left:5mm}.sheet-marker.br{bottom:5mm;right:5mm}
        .student-info{display:grid;grid-template-columns:1fr 1fr;gap:5px;margin-bottom:10px;font-size:12px}
        .info-item{display:flex;align-items:center}.info-item label{width:100px;font-weight:bold}.info-item span{flex:1;border-bottom:1px dashed #999;height:18px}
        .questions-two-column{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}
        .question-item{display:flex;justify-content:space-between;padding:4px 0;border-bottom:1px dotted #ccc;font-size:12px}
        .option-bubble{width:18px;height:18px;border:1.5px solid #333;border-radius:50%;display:inline-flex;justify-content:center;align-items:center;font-size:10px;margin-left:4px}
        .option-bubble.filled::after{content:'';width:12px;height:12px;background:black;border-radius:50%}
        .results-summary{margin-top:10px;padding:10px;border:1px solid #ddd;border-radius:4px;background:#f9f9f9;font-size:12px}
        .summary-grid{display:grid;grid-template-columns:1ب
